```{=html}
<% const listingId = 'listing-' + Math.random().toString(36).substr(2, 9); %>
<div class="research project-list" data-listing-id="<%= listingId %>">
<ul class="list">
    <% for (const item of items) { %>
        <li class="project" <%=metadataAttrs(item) %> data-listing-categories="<%= item.categories ? item.categories.join(',') : '' %>">
            <div class="project-content listing-pub-info">
                <p><%= item['pub-info'].reference %></p>
            </div>

            <% if(item.categories) { %>
            <div class="project-categories">
                <% for (const cat of item.categories) { %>
                    <div class="project-category">
                        <a href="javascript:void(0)" class="category-filter" data-category="<%= cat %>" data-listing="<%= listingId %>"><%= cat %></a>
                    </div>
                    <% } %>
            </div>
            <% } %>

            <% // Loop through the haiku lines and prepend a / to all but the first %>
            <% if (item.haiku) { %>
            <div class="haiku">
            <% for (var i=0; i <= item.haiku.length - 1; i++) { %>
                <% if (i > 0) { %> / <% } %><%= item.haiku[i] %>
            <% } %>
            </div>
            <% } %>
            
            <div class="project-details-listing">
                <ul class="project-links">
                    <li class="project-link details">
                        <a href="<%- item.path %>" class="listing-name">
                            <i class="fa-solid fa-circle-info"></i> Full details Â»
                        </a>
                    </li>
                    <% if (item['pub-info'].links) { %>
                        <% for (const link of item['pub-info'].links) { %>
                    <li class="project-link">
                        <% if (link.local) { %>
                        <a href="<%- item.path.substring(0, item.path.lastIndexOf('/')) %>/<%- link.url %>">
                        <% } else { %>
                        <a href="<%- link.url %>">
                        <% } %>
                            <i class="<%- link.icon %>"></i> <%= link.name %>
                        </a>
                    </li>
                        <% } %>
                    <% } %>
                </ul>
            </div>
        </li>
        <% } %>
</ul>
</div>

<script>
// Initialize category filtering - runs once when first listing loads
(function() {
  if (window.categoryFilterInitialized) return;
  window.categoryFilterInitialized = true;

  // Track active filters per listing
  var activeFilters = {};

  // Initialize when DOM is ready
  function init() {
    // Add click handlers to all category filter links
    document.querySelectorAll('.category-filter').forEach(function(link) {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        var category = this.getAttribute('data-category');
        var listingType = this.getAttribute('data-listing');

        // Toggle filter for this listing
        if (activeFilters[listingType] === category) {
          delete activeFilters[listingType];
          updateListingDisplay(listingType, null);
        } else {
          activeFilters[listingType] = category;
          updateListingDisplay(listingType, category);
        }

        updateCategoryLinks(listingType, activeFilters[listingType]);
      });
    });
  }

  function updateListingDisplay(listingType, category) {
    var listingContainer = document.querySelector('[data-listing-id="' + listingType + '"]');
    if (!listingContainer) return;

    var items = listingContainer.querySelectorAll('.project');
    items.forEach(function(item) {
      if (!category) {
        item.style.display = '';
      } else {
        var categories = item.getAttribute('data-listing-categories');
        if (categories && categories.split(',').indexOf(category) !== -1) {
          item.style.display = '';
        } else {
          item.style.display = 'none';
        }
      }
    });
  }

  function updateCategoryLinks(listingType, activeCategory) {
    var listingContainer = document.querySelector('[data-listing-id="' + listingType + '"]');
    if (!listingContainer) return;

    var links = listingContainer.querySelectorAll('.category-filter[data-listing="' + listingType + '"]');
    links.forEach(function(link) {
      var category = link.getAttribute('data-category');
      if (category === activeCategory) {
        link.classList.add('active');
      } else {
        link.classList.remove('active');
      }
    });
  }

  // Run initialization
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>
```